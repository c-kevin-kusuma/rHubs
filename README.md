# Retrieving and Updating HubSpot objects (rHubs)

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)

## Overview

Building an R package to retrieve, analyze, and update objects on HubSpot such as Companies, Contacts, and Deals. This package is designed to pull and push data between R and HubSpot via API calls using generated API Key. In order to use this package, a valid HubSpot instance and an account with sufficient access are required. All inputs and outputs in this package will be in dataframes. Functions in this package will automatically perform translations between JSON and dataframe to match the required input and output of HubSpot objects.

<br>

## How to Install
Currently, this package is only available through GitHub. You can install this package using devtools github method:
```r
devtools::install_github(repo='c-kevin-kusuma/rHubs', ref='main')
```

<br>

## Examples with Company Object
Pull Request
```r
# Attach the installed rHubs package by calling the library() function
library(rHubs)

# Pull current company properties
properties <- companyProperties(apiKey = apiKey)$name

# Pull current company List - the first batch of 100 companies
current_companies <- companyList(apiKey = apiKey)

# Recursive example to pull all companies
offset <- NA
has_more <- TRUE
all_companies <- list()

for (i in 1:9999999) {
  if (is.na(offset) == TRUE & has_more == TRUE) {
    y <- companyList(apiKey = apiKey)
    offset <- y$offset[1]
    has_more <- y$has_more[1]
    all_companies[[i]] <- y
  }
  else if (is.na(offset) == FALSE & has_more == TRUE) {
    y <- companyList(apiKey = apiKey, offset = offset)
    offset <- y$offset[1]
    has_more <- y$has_more[1]
    all_companies[[i]] <- y
  }
  else if (has_more == FALSE) {
    break
  }
}

all_companies <- dplyr::bind_rows(all_companies)
```

Push Request
```r
# Create/Add New Companies and save the creation report
## "name" field which represents the company's name must present in your "data" input
new_company <- createCompanies(apiKey = apiKey, data = data)

# Update company properties and save the update report
## "companyId" field must presents in the data input
update_report <- updateCompanies(apiKey = apiKey, data = data) 

# Delete Current Companies and save the deletion report
## This "deleteCompanies()" function performs a DESTRUCTIVE action and is best used only to delete companies that were generated by your application
## "companyId" field must presents in the data input
deleted_companies <- deleteCompanies(apiKey = apiKey, companyId = companyId)
```

<br>

## Examples to Convert Date to Unix
HubSpot only accepts Unix-date format ("Millisecond"). It means that you'll need to convert your date fields to unix if you wish to create or update HubSpot objects with date-type properties.
```r
# Create a dummy date value
test_date <- as.Date('2022-01-01')

# Convert the dummy date value to unix
unixed_date <- dateToUnix(test_date, type = 'Millisecond') # HubSpot only accepts unix in "Millisecond"
```

